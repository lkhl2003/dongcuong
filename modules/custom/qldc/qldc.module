<?php
use Drupal\Core\Form\FormStateInterface;
/**
 * @file
 * Allows the creation of custom blocks through the user interface.
 */
function qldc_form_alter(&$form, \Drupal\Core\Form\FormStateInterface $form_state, $form_id)
{
    if ($form_id == 'node_congdan_form') {
        $form['#theme'] = 'dongcuong_node_congdan_form';
        $form['#cache'] = ['max-age' => 0];
    }

    if ($form_id == 'node_xac_nhan_dan_su_form') {
      //dsm($form['field_noithuongtru']['widget']);
        //dsm($form['title']['widget'][0]['value']);
        $form['#prefix'] = '<div id="form_dan_su">';
        $form['#suffix'] = '</div>';
        $form['#theme'] = 'dongcuong_node_xac_nhan_dan_su_form';
        $form['#cache'] = ['max-age' => 0];
        $form['title']['widget'][0]['value']['#autocomplete_route_name'] = 'qldc.autocomplete';
        $form['title']['widget'][0]['value']['#ajax'] = [
          'wrapper' => 'form_dan_su',
          'event' => 'autocompleteclose',
          'callback' => 'qldc_myAjaxCallback',
          'disable-refocus' => false,
        ];
    }
}

function qldc_options_list_alter(array &$options, array $context)
{
    unset($options['_none']);
}

function qldc_myAjaxCallback(array &$form, FormStateInterface $form_state)
{
    $form['field_noithuongtru']['widget'][0]['value']['#value'] = 'Tao thuong tru';
    \Drupal::logger('qldc')->notice('Set noi thuong tru here.');

    //$d = new DateTime();
    //$dateformat = 'Y-m-d';

    //$value = $d->format($dateformat);
    $hovaten = $form_state->getValue('title');
    $date_value = $form_state->getValue('field_ngaysinh');

    dsm($hovaten);

    $form['field_ngaysinh']['widget'][0]['value']['date']['#value'] = '2020-02-05';

    return $form;
}